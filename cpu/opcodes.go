package cpu

import "fmt"

var ops = [256]*Op{
	// opcode: name addr mode size ticks do pageCrossTick
	0xea: {"nop", AmImp, 1, 2, nop, 0},

	0xa9: {"lda", AmImm, 2, 2, lda, 0},
	0xa5: {"lda", AmZeP, 2, 3, lda, 0},
	0xb5: {"lda", AmZeX, 2, 4, lda, 0},
	0xad: {"lda", AmAbs, 3, 4, lda, 0},
	0xbd: {"lda", AmAbX, 3, 4, lda, 1},
	0xb9: {"lda", AmAbY, 3, 4, lda, 1},
	0xa1: {"lda", AmInX, 2, 6, lda, 0},
	0xb1: {"lda", AmInY, 2, 5, lda, 1},

	0xa2: {"ldx", AmImm, 2, 2, ldx, 0},
	0xa6: {"ldx", AmZeP, 2, 3, ldx, 0},
	0xb6: {"ldx", AmZeY, 2, 4, ldx, 0},
	0xae: {"ldx", AmAbs, 3, 4, ldx, 0},
	0xbe: {"ldx", AmAbY, 3, 4, ldx, 1},

	0xa0: {"ldy", AmImm, 2, 2, ldy, 0},
	0xa4: {"ldy", AmZeP, 2, 3, ldy, 0},
	0xb4: {"ldy", AmZeX, 2, 4, ldy, 0},
	0xac: {"ldy", AmAbs, 3, 4, ldy, 0},
	0xbc: {"ldy", AmAbX, 3, 4, ldy, 1},

	0x85: {"sta", AmZeP, 2, 3, sta, 0},
	0x95: {"sta", AmZeX, 2, 4, sta, 0},
	0x8d: {"sta", AmAbs, 3, 4, sta, 0},
	0x9d: {"sta", AmAbX, 3, 5, sta, 0},
	0x99: {"sta", AmAbY, 3, 5, sta, 0},
	0x81: {"sta", AmInX, 2, 6, sta, 0},
	0x91: {"sta", AmInY, 2, 6, sta, 0},

	0x86: {"stx", AmZeP, 2, 3, stx, 0},
	0x96: {"stx", AmZeY, 2, 4, stx, 0},
	0x8e: {"stx", AmAbs, 3, 4, stx, 0},

	0x84: {"sty", AmZeP, 2, 3, sty, 0},
	0x94: {"sty", AmZeX, 2, 4, sty, 0},
	0x8c: {"sty", AmAbs, 3, 4, sty, 0},

	0xaa: {"tax", AmImp, 1, 2, tax, 0},
	0xa8: {"tay", AmImp, 1, 2, tay, 0},
	0xba: {"tsx", AmImp, 1, 2, tsx, 0},
	0x8a: {"txa", AmImp, 1, 2, txa, 0},
	0x9a: {"txs", AmImp, 1, 2, txs, 0},
	0x98: {"tya", AmImp, 1, 2, tya, 0},

	0x48: {"pha", AmImp, 1, 3, pha, 0},
	0x68: {"pla", AmImp, 1, 4, pla, 0},
	0x08: {"php", AmImp, 1, 3, php, 0},
	0x28: {"plp", AmImp, 1, 4, plp, 0},

	0x4c: {"jmp", AmAbs, 3, 3, jmp, 0},
	0x6c: {"jmp", AmInd, 3, 5, jmp, 0},

	0x20: {"jsr", AmAbs, 3, 6, jsr, 0},
	0x60: {"rts", AmImp, 1, 6, rts, 0},

	0x00: {"brk", AmImp, 1, 7, brk, 0},
	0x40: {"rti", AmImp, 1, 6, rti, 0},

	// handle extra ticks inside op
	0xb0: {"bcs", AmRel, 2, 2, bcs, 0},
	0x90: {"bcc", AmRel, 2, 2, bcc, 0},
	0xf0: {"beq", AmRel, 2, 2, beq, 0},
	0xd0: {"bne", AmRel, 2, 2, bne, 0},
	0x30: {"bmi", AmRel, 2, 2, bmi, 0},
	0x10: {"bpl", AmRel, 2, 2, bpl, 0},
	0x70: {"bvs", AmRel, 2, 2, bvs, 0},
	0x50: {"bvc", AmRel, 2, 2, bvc, 0},

	0x18: {"clc", AmImp, 1, 2, clc, 0},
	0xd8: {"cld", AmImp, 1, 2, cld, 0},
	0x58: {"cli", AmImp, 1, 2, cli, 0},
	0xb8: {"clv", AmImp, 1, 2, clv, 0},

	0x38: {"sec", AmImp, 1, 2, sec, 0},
	0xf8: {"sed", AmImp, 1, 2, sed, 0},
	0x78: {"sei", AmImp, 1, 2, sei, 0},

	0xc6: {"dec", AmZeP, 2, 5, dec, 0},
	0xd6: {"dec", AmZeX, 2, 6, dec, 0},
	0xce: {"dec", AmAbs, 2, 6, dec, 0},
	0xde: {"dec", AmAbX, 2, 7, dec, 0},

	0xca: {"dex", AmImp, 1, 2, dex, 0},
	0x88: {"dey", AmImp, 1, 2, dey, 0},

	0xe6: {"inc", AmZeP, 2, 5, inc, 0},
	0xf6: {"inc", AmZeX, 2, 6, inc, 0},
	0xee: {"inc", AmAbs, 2, 6, inc, 0},
	0xfe: {"inc", AmAbX, 2, 7, inc, 0},

	0xe8: {"inx", AmImp, 1, 2, inx, 0},
	0xc8: {"iny", AmImp, 1, 2, iny, 0},

	0x0a: {"asl", AmAcc, 1, 2, asl, 0},
	0x06: {"asl", AmZeP, 2, 5, asl, 0},
	0x16: {"asl", AmZeX, 2, 6, asl, 0},
	0x0e: {"asl", AmAbs, 3, 6, asl, 0},
	0x1e: {"asl", AmAbX, 3, 7, asl, 0},

	0x4a: {"lsr", AmAcc, 1, 2, lsr, 0},
	0x46: {"lsr", AmZeP, 2, 5, lsr, 0},
	0x56: {"lsr", AmZeX, 2, 6, lsr, 0},
	0x4e: {"lsr", AmAbs, 3, 6, lsr, 0},
	0x5e: {"lsr", AmAbX, 3, 7, lsr, 0},

	0x2a: {"rol", AmAcc, 1, 2, rol, 0},
	0x26: {"rol", AmZeP, 2, 5, rol, 0},
	0x36: {"rol", AmZeX, 2, 6, rol, 0},
	0x2e: {"rol", AmAbs, 3, 6, rol, 0},
	0x3e: {"rol", AmAbX, 3, 7, rol, 0},

	0x6a: {"ror", AmAcc, 1, 2, ror, 0},
	0x66: {"ror", AmZeP, 2, 5, ror, 0},
	0x76: {"ror", AmZeX, 2, 6, ror, 0},
	0x6e: {"ror", AmAbs, 3, 6, ror, 0},
	0x7e: {"ror", AmAbX, 3, 7, ror, 0},

	0x29: {"and", AmImm, 2, 2, and, 0},
	0x25: {"and", AmZeP, 2, 3, and, 0},
	0x35: {"and", AmZeX, 2, 4, and, 0},
	0x2d: {"and", AmAbs, 3, 4, and, 0},
	0x3d: {"and", AmAbX, 3, 4, and, 1},
	0x39: {"and", AmAbY, 3, 4, and, 1},
	0x21: {"and", AmInX, 2, 6, and, 0},
	0x31: {"and", AmInY, 2, 5, and, 1},

	0x09: {"ora", AmImm, 2, 2, ora, 0},
	0x05: {"ora", AmZeP, 2, 3, ora, 0},
	0x15: {"ora", AmZeX, 2, 4, ora, 0},
	0x0d: {"ora", AmAbs, 3, 4, ora, 0},
	0x1d: {"ora", AmAbX, 3, 4, ora, 1},
	0x19: {"ora", AmAbY, 3, 4, ora, 1},
	0x01: {"ora", AmInX, 2, 6, ora, 0},
	0x11: {"ora", AmInY, 2, 5, ora, 1},

	0x49: {"eor", AmImm, 2, 2, eor, 0},
	0x45: {"eor", AmZeP, 2, 3, eor, 0},
	0x55: {"eor", AmZeX, 2, 4, eor, 0},
	0x4d: {"eor", AmAbs, 3, 4, eor, 0},
	0x5d: {"eor", AmAbX, 3, 4, eor, 1},
	0x59: {"eor", AmAbY, 3, 4, eor, 1},
	0x41: {"eor", AmInX, 2, 6, eor, 0},
	0x51: {"eor", AmInY, 2, 5, eor, 1},

	0x24: {"bit", AmZeP, 2, 3, bit, 0},
	0x2c: {"bit", AmAbs, 3, 4, bit, 0},

	0x69: {"adc", AmImm, 2, 2, adc, 0},
	0x65: {"adc", AmZeP, 2, 3, adc, 0},
	0x75: {"adc", AmZeX, 2, 4, adc, 0},
	0x6d: {"adc", AmAbs, 3, 4, adc, 0},
	0x7d: {"adc", AmAbX, 3, 4, adc, 1},
	0x79: {"adc", AmAbY, 3, 4, adc, 1},
	0x61: {"adc", AmInX, 2, 6, adc, 0},
	0x71: {"adc", AmInY, 2, 5, adc, 1},

	0xe9: {"sbc", AmImm, 2, 2, sbc, 0},
	0xe5: {"sbc", AmZeP, 2, 3, sbc, 0},
	0xf5: {"sbc", AmZeX, 2, 4, sbc, 0},
	0xed: {"sbc", AmAbs, 3, 4, sbc, 0},
	0xfd: {"sbc", AmAbX, 3, 4, sbc, 1},
	0xf9: {"sbc", AmAbY, 3, 4, sbc, 1},
	0xe1: {"sbc", AmInX, 2, 6, sbc, 0},
	0xf1: {"sbc", AmInY, 2, 5, sbc, 1},

	0xc9: {"cmp", AmImm, 2, 2, cmp, 0},
	0xc5: {"cmp", AmZeP, 2, 3, cmp, 0},
	0xd5: {"cmp", AmZeX, 2, 4, cmp, 0},
	0xcd: {"cmp", AmAbs, 3, 4, cmp, 0},
	0xdd: {"cmp", AmAbX, 3, 4, cmp, 1},
	0xd9: {"cmp", AmAbY, 3, 4, cmp, 1},
	0xc1: {"cmp", AmInX, 2, 6, cmp, 0},
	0xd1: {"cmp", AmInY, 2, 5, cmp, 1},

	0xe0: {"cpx", AmImm, 2, 2, cpx, 0},
	0xe4: {"cpx", AmZeP, 2, 3, cpx, 0},
	0xec: {"cpx", AmAbs, 3, 4, cpx, 0},

	0xc0: {"cpy", AmImm, 2, 2, cpy, 0},
	0xc4: {"cpy", AmZeP, 2, 3, cpy, 0},
	0xcc: {"cpy", AmAbs, 3, 4, cpy, 0},

	// undocumented, 0
	0x1a: {"nop", AmImp, 1, 2, nop, 0},
	0x3a: {"nop", AmImp, 1, 2, nop, 0},
	0x5a: {"nop", AmImp, 1, 2, nop, 0},
	0x7a: {"nop", AmImp, 1, 2, nop, 0},
	0xda: {"nop", AmImp, 1, 2, nop, 0},
	0xfa: {"nop", AmImp, 1, 2, nop, 0},
	0x80: {"nop", AmImm, 2, 2, nop, 0},
	0x82: {"nop", AmImm, 2, 2, nop, 0},
	0x89: {"nop", AmImm, 2, 2, nop, 0},
	0xc2: {"nop", AmImm, 2, 2, nop, 0},
	0xe2: {"nop", AmImm, 2, 2, nop, 0},
	0x0c: {"nop", AmAbs, 3, 4, nop, 0},
	0x1c: {"nop", AmAbX, 3, 4, nop, 1},
	0x3c: {"nop", AmAbX, 3, 4, nop, 1},
	0x5c: {"nop", AmAbX, 3, 4, nop, 1},
	0x7c: {"nop", AmAbX, 3, 4, nop, 1},
	0xdc: {"nop", AmAbX, 3, 4, nop, 1},
	0xfc: {"nop", AmAbX, 3, 4, nop, 1},
	0x04: {"nop", AmZeP, 2, 3, nop, 0},
	0x44: {"nop", AmZeP, 2, 3, nop, 0},
	0x64: {"nop", AmZeP, 2, 3, nop, 0},
	0x14: {"nop", AmZeX, 2, 4, nop, 0},
	0x34: {"nop", AmZeX, 2, 4, nop, 0},
	0x54: {"nop", AmZeX, 2, 4, nop, 0},
	0x74: {"nop", AmZeX, 2, 4, nop, 0},
	0xd4: {"nop", AmZeX, 2, 4, nop, 0},
	0xf4: {"nop", AmZeX, 2, 4, nop, 0},

	0x0f: {"slo", AmAbs, 3, 6, slo, 0},
	0x1f: {"slo", AmAbX, 3, 7, slo, 0},
	0x1b: {"slo", AmAbY, 3, 7, slo, 0},
	0x07: {"slo", AmZeP, 2, 5, slo, 0},
	0x17: {"slo", AmZeX, 2, 6, slo, 0},
	0x03: {"slo", AmInX, 2, 8, slo, 0},
	0x13: {"slo", AmInY, 2, 8, slo, 0},

	0x2f: {"rla", AmAbs, 3, 6, rla, 0},
	0x3f: {"rla", AmAbX, 3, 7, rla, 0},
	0x3b: {"rla", AmAbY, 3, 7, rla, 0},
	0x27: {"rla", AmZeP, 2, 5, rla, 0},
	0x37: {"rla", AmZeX, 2, 6, rla, 0},
	0x23: {"rla", AmInX, 2, 8, rla, 0},
	0x33: {"rla", AmInY, 2, 8, rla, 0},

	0x4f: {"sre", AmAbs, 3, 6, sre, 0},
	0x5f: {"sre", AmAbX, 3, 7, sre, 0},
	0x5b: {"sre", AmAbY, 3, 7, sre, 0},
	0x47: {"sre", AmZeP, 2, 5, sre, 0},
	0x57: {"sre", AmZeX, 2, 6, sre, 0},
	0x43: {"sre", AmInX, 2, 8, sre, 0},
	0x53: {"sre", AmInY, 2, 8, sre, 0},

	0x6f: {"rra", AmAbs, 3, 6, rra, 0},
	0x7f: {"rra", AmAbX, 3, 7, rra, 0},
	0x7b: {"rra", AmAbY, 3, 7, rra, 0},
	0x67: {"rra", AmZeP, 2, 5, rra, 0},
	0x77: {"rra", AmZeX, 2, 6, rra, 0},
	0x63: {"rra", AmInX, 2, 8, rra, 0},
	0x73: {"rra", AmInY, 2, 8, rra, 0},

	0xcf: {"dcp", AmAbs, 3, 6, dcp, 0},
	0xdf: {"dcp", AmAbX, 3, 7, dcp, 0},
	0xdb: {"dcp", AmAbY, 3, 7, dcp, 0},
	0xc7: {"dcp", AmZeP, 2, 5, dcp, 0},
	0xd7: {"dcp", AmZeX, 2, 6, dcp, 0},
	0xc3: {"dcp", AmInX, 2, 8, dcp, 0},
	0xd3: {"dcp", AmInY, 2, 8, dcp, 0},

	0xef: {"isc", AmAbs, 3, 6, isc, 0},
	0xff: {"isc", AmAbX, 3, 7, isc, 0},
	0xfb: {"isc", AmAbY, 3, 7, isc, 0},
	0xe7: {"isc", AmZeP, 2, 5, isc, 0},
	0xf7: {"isc", AmZeX, 2, 6, isc, 0},
	0xe3: {"isc", AmInX, 2, 8, isc, 0},
	0xf3: {"isc", AmInY, 2, 8, isc, 0},

	0xaf: {"lax", AmAbs, 2, 4, lax, 0},
	0xbf: {"lax", AmAbY, 3, 4, lax, 1},
	0xa7: {"lax", AmZeP, 2, 3, lax, 0},
	0xb7: {"lax", AmZeY, 2, 4, lax, 0},
	0xa3: {"lax", AmInX, 2, 6, lax, 0},
	0xb3: {"lax", AmInY, 2, 5, lax, 1},

	0x8f: {"sax", AmAbs, 3, 4, sax, 0},
	0x87: {"sax", AmZeP, 2, 3, sax, 0},
	0x97: {"sax", AmZeY, 2, 4, sax, 0},
	0x83: {"sax", AmInX, 2, 6, sax, 0},

	0x0b: {"anc", AmImm, 2, 2, anc, 0},
	0x2b: {"anc", AmImm, 2, 2, anc, 0},
	0x4b: {"asr", AmImm, 2, 2, asr, 0},
	0x6b: {"arr", AmImm, 2, 2, arr, 0},
	0x8b: {"xaa", AmImm, 2, 2, xaa, 0},
	0xab: {"lxa", AmImm, 2, 2, lxa, 0},
	0xbb: {"las", AmAbY, 3, 4, las, 1},
	0xcb: {"sbx", AmImm, 2, 2, sbx, 0},
	0xeb: {"sbc", AmImm, 2, 2, sbc, 0},

	0x9f: {"sha", AmAbY, 3, 5, sha, 0},
	0x93: {"sha", AmInY, 2, 6, sha, 0},
	0x9e: {"shx", AmAbY, 3, 5, shx, 0},
	0x9c: {"shy", AmAbX, 3, 5, shy, 0},
	0x9b: {"shs", AmAbY, 3, 5, shs, 0},

	0x02: {"jam", AmImp, 1, 1, jam, 0},
	0x12: {"jam", AmImp, 1, 1, jam, 0},
	0x22: {"jam", AmImp, 1, 1, jam, 0},
	0x32: {"jam", AmImp, 1, 1, jam, 0},
	0x42: {"jam", AmImp, 1, 1, jam, 0},
	0x52: {"jam", AmImp, 1, 1, jam, 0},
	0x62: {"jam", AmImp, 1, 1, jam, 0},
	0x72: {"jam", AmImp, 1, 1, jam, 0},
	0x92: {"jam", AmImp, 1, 1, jam, 0},
	0xb2: {"jam", AmImp, 1, 1, jam, 0},
	0xd2: {"jam", AmImp, 1, 1, jam, 0},
	0xf2: {"jam", AmImp, 1, 1, jam, 0},
}

func opcode2op(opcode uint8) *Op {
	op := ops[opcode]

	if op == nil {
		panic(fmt.Sprintf("Unknown opcode 0x%02x", opcode))
	}

	return op
}
